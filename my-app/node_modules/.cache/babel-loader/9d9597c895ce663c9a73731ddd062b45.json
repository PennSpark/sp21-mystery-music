{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\david\\\\mystery-music2\\\\sp21-mystery-music\\\\my-app\\\\src\\\\App.js\";\n// App.js\nimport React, { Component } from 'react';\nimport Game from './Game';\nimport game from './Board';\nimport * as PubNubReact from 'pubnub-react';\nimport Swal from \"sweetalert2\";\nimport shortid from 'shortid';\nimport axios from 'axios';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onPressCreate = e => {\n      this.size = 1; // Create a random name for the channel\n\n      this.roomId = shortid.generate().substring(0, 5);\n      this.lobbyChannel = 'spotifylobby--' + this.roomId; //endpoint for creating a new game in databsae\n\n      const newGame = {\n        joincode: this.roomId\n      };\n      axios.post('http://localhost:5000/games/add', newGame).then(res => console.log(res.data));\n      this.pubnub.subscribe({\n        channels: [this.lobbyChannel],\n        withPresence: true\n      }); // Open the modal sweetalert2\n\n      Swal.mixin({\n        confirmButtonText: 'Next &rarr;',\n        showCancelButton: true,\n        progressSteps: ['1', '2']\n      }).queue([{\n        title: 'Share this room ID with your friend',\n        text: this.roomId\n      }, {\n        title: 'Type your username here',\n        input: 'text'\n      }]).then(result => {\n        if (result.value) {\n          // const answers = JSON.stringify(result.value)\n          Swal.fire({\n            html: `\n            Your username:\n            <pre><code>${result.value[1]}</code></pre>\n          `,\n            confirmButtonText: 'Play!'\n          });\n          this.setState({\n            player: result.value[1],\n            isRoomCreator: true,\n            isDisabled: true,\n            // Disable the 'Create' button\n            myTurn: true // Room creator makes the 1st move\n\n          }); //endpoint for adding a new player to a game in databsae\n\n          const newPlayer = {\n            joincode: result.value[0],\n            name: \"filler\",\n            id: result.value[1]\n          };\n          axios.post('http://localhost:5000/games/addPlayer', newPlayer).then(res => console.log(res.data));\n        }\n      });\n    };\n\n    this.onPressJoin = e => {\n      Swal.mixin({\n        confirmButtonText: 'Next &rarr;',\n        showCancelButton: true,\n        progressSteps: ['1', '2']\n      }).queue([{\n        inputPlaceholder: 'Enter the room id',\n        input: 'text'\n      }, {\n        title: 'Type your username here',\n        input: 'text'\n      }]).then(result => {\n        if (result.value) {\n          // const answers = JSON.stringify(result.value)\n          Swal.fire({\n            html: `\n            Your username:\n            <pre><code>${result.value[1]}</code></pre>\n          `,\n            confirmButtonText: 'Play!'\n          }); // Check if the user typed a value in the input field\n\n          if (result.value[1]) {\n            this.joinRoom(result.value[0]);\n            this.setState({\n              player: result.value[1]\n            }); //endpoint for adding a new player to a game in databsae\n\n            const newPlayer = {\n              joincode: result.value[0],\n              name: \"filler\",\n              id: result.value[1]\n            };\n            axios.post('http://localhost:5000/games/addPlayer', newPlayer).then(res => console.log(res.data));\n          }\n        }\n      });\n    };\n\n    this.joinRoom = value => {\n      this.roomId = value;\n      this.lobbyChannel = 'spotifylobby--' + this.roomId; // Check the number of people in the channel\n\n      this.pubnub.hereNow({\n        channels: [this.lobbyChannel]\n      }).then(response => {\n        if (response.totalOccupancy < 8) {\n          this.size += 1;\n          this.pubnub.subscribe({\n            channels: [this.lobbyChannel],\n            withPresence: true\n          });\n          this.pubnub.publish({\n            message: {\n              notRoomCreator: true\n            },\n            channel: this.lobbyChannel\n          });\n        } else {\n          // Game in progress\n          Swal.fire({\n            title: 'Error',\n            text: 'Game is full.'\n          });\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.endGame = () => {\n      this.setState({\n        player: '',\n        isPlaying: false,\n        isRoomCreator: false,\n        isDisabled: false,\n        myTurn: false\n      });\n      this.lobbyChannel = null;\n      this.gameChannel = null;\n      this.roomId = null;\n      this.pubnub.unsubscribe({\n        channels: [this.lobbyChannel, this.gameChannel]\n      });\n    };\n\n    this.pubnub = new PubNubReact({\n      publishKey: \"pub-c-353f0377-1a09-4a4f-be96-1f51d601592c\",\n      subscribeKey: \"sub-c-7cb8e092-8c1a-11eb-9de7-3a1dcc291cdf\"\n    });\n    this.state = {\n      player: '',\n      // 1, 2, 3, 4, 5\n      isPlaying: false,\n      // Set to true when at least 2 players are in a channel\n      isRoomCreator: false,\n      isDisabled: false,\n      myTurn: false\n    };\n    this.lobbyChannel = null; // Lobby channel\n\n    this.gameChannel = null; // Game channel\n\n    this.size = null; // Number of players in room\n\n    this.roomId = null; // Unique id when player creates a room\n\n    this.pubnub.init(this); // Initialize PubNub\n  }\n\n  componentWillUnmount() {\n    this.pubnub.unsubscribe({\n      channels: [this.lobbyChannel, this.gameChannel]\n    });\n  }\n\n  componentDidUpdate() {\n    // Check that the player is connected to a channel\n    if (this.lobbyChannel != null) {\n      this.pubnub.getMessage(this.lobbyChannel, msg => {\n        // Start the game once an opponent joins the channel\n        if (msg.message.notRoomCreator) {\n          // Create a different channel for the game\n          this.gameChannel = 'spotifygame--' + this.roomId;\n          this.pubnub.subscribe({\n            channels: [this.gameChannel]\n          });\n          this.setState({\n            isPlaying: true\n          }); // Close the modals if they are opened\n\n          Swal.close();\n        }\n      });\n    }\n  } // Create a room channel\n\n\n  render() {\n    return (\n      /*#__PURE__*/\n\n      /*\r\n      <div>\r\n        <div className=\"title\">\r\n          <h1> MysteryMusic </h1>\r\n        </div>\r\n        {\r\n          !this.state.isPlaying &&\r\n          <div className=\"game\">\r\n            <div className=\"board\">\r\n              <div className=\"button-container\">\r\n                <div id=\"create-container\">\r\n                  <h2>Host</h2>\r\n                  <h3>Start the game!</h3> <br></br>\r\n                  <h4>Create the game for other players to join</h4>\r\n                <button\r\n                  className=\"button \"\r\n                  disabled={this.state.isDisabled}\r\n                  onClick={(e) => this.onPressCreate()}\r\n                > Create\r\n                </button>\r\n                </div>\r\n                <div id=\"join-container\">\r\n                <h2>Joiner</h2>\r\n                  <h3>Join a game!</h3> <br></br>\r\n                  <h4>Join a game another player is hosting</h4>\r\n                <button\r\n                  className=\"button\"\r\n                  onClick={(e) => this.onPressJoin()}\r\n                > Join\r\n                </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        }\r\n      </div>\r\n      */\n      _jsxDEV(\"div\", {\n        class: \"home\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"group\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"place avenirltstd-55roman-normal-black-18px\",\n            children: \"Home\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"about avenirltstd-55roman-normal-black-18px\",\n            children: \"About\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"contact avenirltstd-55roman-normal-black-18px\",\n            children: \"Team\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          class: \"mystery-music-logo-1\",\n          src: \"https://anima-uploads.s3.amazonaws.com/projects/60760a93d4d62b3f8b0aea2b/releases/6078ee0985f5e7f39b088386/img/mysterymusic-logo-1@2x.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"text-1 arial-narrowbolditalic-bold-white-18px\",\n          children: \"Think you know your friends well? Guess who\\u2019s playlist the song is from!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"flex-row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"create-container\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              disabled: this.state.isDisabled,\n              onClick: e => this.onPressCreate(),\n              children: \" Create\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 289,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"join-container\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: e => this.onPressJoin(),\n              children: \" Join\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 6\n      }, this)\n    );\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/david/mystery-music2/sp21-mystery-music/my-app/src/App.js"],"names":["React","Component","Game","game","PubNubReact","Swal","shortid","axios","App","constructor","props","onPressCreate","e","size","roomId","generate","substring","lobbyChannel","newGame","joincode","post","then","res","console","log","data","pubnub","subscribe","channels","withPresence","mixin","confirmButtonText","showCancelButton","progressSteps","queue","title","text","input","result","value","fire","html","setState","player","isRoomCreator","isDisabled","myTurn","newPlayer","name","id","onPressJoin","inputPlaceholder","joinRoom","hereNow","response","totalOccupancy","publish","message","notRoomCreator","channel","catch","error","endGame","isPlaying","gameChannel","unsubscribe","publishKey","subscribeKey","state","init","componentWillUnmount","componentDidUpdate","getMessage","msg","close","render"],"mappings":"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","sourcesContent":["// App.js\r\nimport React, { Component } from 'react';\r\nimport Game from './Game';\r\nimport game from './Board';\r\nimport * as PubNubReact from 'pubnub-react';\r\nimport Swal from \"sweetalert2\";\r\nimport shortid from 'shortid';\r\nimport axios from 'axios';\r\nimport './App.css';\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.pubnub = new PubNubReact({\r\n      publishKey: \"pub-c-353f0377-1a09-4a4f-be96-1f51d601592c\",\r\n      subscribeKey: \"sub-c-7cb8e092-8c1a-11eb-9de7-3a1dcc291cdf\"\r\n    });\r\n    this.state = {\r\n      player: '', // 1, 2, 3, 4, 5\r\n      isPlaying: false, // Set to true when at least 2 players are in a channel\r\n      isRoomCreator: false,\r\n      isDisabled: false,\r\n      myTurn: false,\r\n    };\r\n    this.lobbyChannel = null; // Lobby channel\r\n    this.gameChannel = null; // Game channel\r\n    this.size = null; // Number of players in room\r\n    this.roomId = null; // Unique id when player creates a room\r\n    this.pubnub.init(this); // Initialize PubNub\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.pubnub.unsubscribe({\r\n      channels: [this.lobbyChannel, this.gameChannel]\r\n    });\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    // Check that the player is connected to a channel\r\n    if (this.lobbyChannel != null) {\r\n      this.pubnub.getMessage(this.lobbyChannel, (msg) => {\r\n        // Start the game once an opponent joins the channel\r\n        if (msg.message.notRoomCreator) {\r\n          // Create a different channel for the game\r\n          this.gameChannel = 'spotifygame--' + this.roomId;\r\n\r\n          this.pubnub.subscribe({\r\n            channels: [this.gameChannel]\r\n          });\r\n\r\n          this.setState({\r\n            isPlaying: true\r\n          });\r\n\r\n          // Close the modals if they are opened\r\n          Swal.close();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Create a room channel\r\n  onPressCreate = (e) => {\r\n    this.size = 1;\r\n    // Create a random name for the channel\r\n    this.roomId = shortid.generate().substring(0, 5);\r\n    this.lobbyChannel = 'spotifylobby--' + this.roomId;\r\n\r\n    //endpoint for creating a new game in databsae\r\n    const newGame = {\r\n      joincode: this.roomId,\r\n    };\r\n    axios.post('http://localhost:5000/games/add', newGame)\r\n      .then(res => console.log(res.data));\r\n\r\n    this.pubnub.subscribe({\r\n      channels: [this.lobbyChannel],\r\n      withPresence: true\r\n    });\r\n\r\n    // Open the modal sweetalert2\r\n    Swal.mixin({\r\n      confirmButtonText: 'Next &rarr;',\r\n      showCancelButton: true,\r\n      progressSteps: ['1', '2']\r\n    }).queue([\r\n      {\r\n        title: 'Share this room ID with your friend',\r\n        text: this.roomId\r\n      },\r\n      {\r\n        title: 'Type your username here',\r\n        input: 'text'\r\n      }\r\n    ]).then((result) => {\r\n      if (result.value) {\r\n        // const answers = JSON.stringify(result.value)\r\n        Swal.fire({\r\n          html: `\r\n            Your username:\r\n            <pre><code>${result.value[1]}</code></pre>\r\n          `,\r\n          confirmButtonText: 'Play!'\r\n        });\r\n\r\n        this.setState({\r\n          player: result.value[1],\r\n          isRoomCreator: true,\r\n          isDisabled: true, // Disable the 'Create' button\r\n          myTurn: true, // Room creator makes the 1st move\r\n        });\r\n\r\n        //endpoint for adding a new player to a game in databsae\r\n        const newPlayer = {\r\n          joincode: result.value[0],\r\n          name: \"filler\",\r\n          id: result.value[1]\r\n        };\r\n        axios.post('http://localhost:5000/games/addPlayer', newPlayer)\r\n          .then(res => console.log(res.data));\r\n      }\r\n    })\r\n  }\r\n\r\n  // The 'Join' button was pressed\r\n  onPressJoin = (e) => {\r\n\r\n    Swal.mixin({\r\n      confirmButtonText: 'Next &rarr;',\r\n      showCancelButton: true,\r\n      progressSteps: ['1', '2']\r\n    }).queue([\r\n      {\r\n        inputPlaceholder: 'Enter the room id',\r\n        input: 'text'\r\n      },\r\n      {\r\n        title: 'Type your username here',\r\n        input: 'text'\r\n      }\r\n    ]).then((result) => {\r\n      if (result.value) {\r\n        // const answers = JSON.stringify(result.value)\r\n        Swal.fire({\r\n          html: `\r\n            Your username:\r\n            <pre><code>${result.value[1]}</code></pre>\r\n          `,\r\n          confirmButtonText: 'Play!'\r\n        });\r\n        // Check if the user typed a value in the input field\r\n        if (result.value[1]) {\r\n          this.joinRoom(result.value[0]);\r\n\r\n          this.setState({\r\n            player: result.value[1],\r\n          });\r\n\r\n          //endpoint for adding a new player to a game in databsae\r\n          const newPlayer = {\r\n            joincode: result.value[0],\r\n            name: \"filler\",\r\n            id: result.value[1]\r\n          };\r\n\r\n          axios.post('http://localhost:5000/games/addPlayer', newPlayer)\r\n            .then(res => console.log(res.data));\r\n        }\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  // Join a room channel\r\n  joinRoom = (value) => {\r\n    this.roomId = value;\r\n    this.lobbyChannel = 'spotifylobby--' + this.roomId;\r\n\r\n    // Check the number of people in the channel\r\n    this.pubnub.hereNow({\r\n      channels: [this.lobbyChannel],\r\n    }).then((response) => {\r\n      if (response.totalOccupancy < 8) {\r\n        this.size += 1;\r\n\r\n        this.pubnub.subscribe({\r\n          channels: [this.lobbyChannel],\r\n          withPresence: true\r\n        });\r\n\r\n        this.pubnub.publish({\r\n          message: {\r\n            notRoomCreator: true,\r\n          },\r\n          channel: this.lobbyChannel\r\n        });\r\n      }\r\n      else {\r\n        // Game in progress\r\n        Swal.fire({\r\n          title: 'Error',\r\n          text: 'Game is full.',\r\n        })\r\n      }\r\n    }).catch((error) => {\r\n      console.log(error);\r\n    });\r\n  }\r\n\r\n  // Reset everything\r\n  endGame = () => {\r\n    this.setState({\r\n      player: '',\r\n      isPlaying: false,\r\n      isRoomCreator: false,\r\n      isDisabled: false,\r\n      myTurn: false,\r\n    });\r\n\r\n    this.lobbyChannel = null;\r\n    this.gameChannel = null;\r\n    this.roomId = null;\r\n\r\n    this.pubnub.unsubscribe({\r\n      channels: [this.lobbyChannel, this.gameChannel]\r\n    });\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n    return (\r\n      /*\r\n      <div>\r\n        <div className=\"title\">\r\n          <h1> MysteryMusic </h1>\r\n        </div>\r\n        {\r\n          !this.state.isPlaying &&\r\n          <div className=\"game\">\r\n            <div className=\"board\">\r\n              <div className=\"button-container\">\r\n                <div id=\"create-container\">\r\n                  <h2>Host</h2>\r\n                  <h3>Start the game!</h3> <br></br>\r\n                  <h4>Create the game for other players to join</h4>\r\n                <button\r\n                  className=\"button \"\r\n                  disabled={this.state.isDisabled}\r\n                  onClick={(e) => this.onPressCreate()}\r\n                > Create\r\n                </button>\r\n                </div>\r\n                <div id=\"join-container\">\r\n                <h2>Joiner</h2>\r\n                  <h3>Join a game!</h3> <br></br>\r\n                  <h4>Join a game another player is hosting</h4>\r\n                <button\r\n                  className=\"button\"\r\n                  onClick={(e) => this.onPressJoin()}\r\n                > Join\r\n                </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        }\r\n      </div>\r\n\r\n    */\r\n\r\n\r\n     <div class=\"home\">\r\n      <div class=\"group\">\r\n        <div class=\"place avenirltstd-55roman-normal-black-18px\">Home</div>\r\n        <div class=\"about avenirltstd-55roman-normal-black-18px\">About</div>\r\n        <div class=\"contact avenirltstd-55roman-normal-black-18px\">Team</div>\r\n      </div>\r\n      <img\r\n        class=\"mystery-music-logo-1\"\r\n        src=\"https://anima-uploads.s3.amazonaws.com/projects/60760a93d4d62b3f8b0aea2b/releases/6078ee0985f5e7f39b088386/img/mysterymusic-logo-1@2x.png\"\r\n        />\r\n      <div class=\"text-1 arial-narrowbolditalic-bold-white-18px\">\r\n        Think you know your friends well? Guess who’s playlist the song is from!\r\n      </div>\r\n      <div class=\"flex-row\">\r\n        <div class=\"create-container\">\r\n          <button\r\n              disabled={this.state.isDisabled}\r\n              onClick={(e) => this.onPressCreate()}\r\n            > Create\r\n          </button>\r\n        </div>\r\n        <div class=\"join-container\">\r\n          <button\r\n                onClick={(e) => this.onPressJoin()}\r\n              > Join\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>  \r\n\r\n\r\n  \r\n\r\n\r\n                                \r\n    );\r\n  }\r\n}\r\nexport default App;"]},"metadata":{},"sourceType":"module"}