{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\egg\\\\Desktop\\\\UPenn\\\\sem 4\\\\pcl\\\\mystery music\\\\my-app\\\\src\\\\App.js\";\n// App.js\nimport React, { Component } from 'react';\nimport * as PubNubReact from 'pubnub-react';\nimport Swal from \"sweetalert2\";\nimport shortid from 'shortid';\nimport './index.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onPressCreate = e => {\n      this.size = 1; // Create a random name for the channel\n\n      this.roomId = shortid.generate().substring(0, 5);\n      this.lobbyChannel = 'spotifylobby--' + this.roomId;\n      this.pubnub.subscribe({\n        channels: [this.lobbyChannel],\n        withPresence: true\n      }); // Open the modal sweetalert2\n\n      Swal.mixin({\n        confirmButtonText: 'Next &rarr;',\n        showCancelButton: true,\n        progressSteps: ['1', '2']\n      }).queue([{\n        title: 'Share this room ID with your friend',\n        text: this.roomId\n      }, {\n        title: 'Type your spotify here',\n        input: 'text'\n      }]).then(result => {\n        if (result.value) {\n          // not sure if need to stringify with only one input, can't test ):\n          // const answers = JSON.stringify(result.value[1])\n          Swal.fire({\n            html: `\n            Your spotify:\n            <pre><code>${result.value[1]}</code></pre>\n          `,\n            confirmButtonText: 'Play!'\n          });\n        }\n      });\n      this.setState({\n        player: '1',\n        isRoomCreator: true,\n        isDisabled: true,\n        // Disable the 'Create' button\n        myTurn: true // Room creator makes the 1st move\n\n      });\n    };\n\n    this.onPressJoin = e => {\n      Swal.mixin({\n        confirmButtonText: 'Next &rarr;',\n        showCancelButton: true,\n        progressSteps: ['1', '2']\n      }).queue([{\n        inputPlaceholder: 'Enter the room id',\n        input: 'text'\n      }, {\n        title: 'Type your spotify here',\n        input: 'text'\n      }]).then(result => {\n        if (result.value) {\n          const answers = JSON.stringify(result.value);\n          Swal.fire({\n            html: `\n            Your spotify:\n            <pre><code>${answers[0]}</code></pre>\n          `,\n            confirmButtonText: 'Play!'\n          }); // Check if the user typed a value in the input field\n\n          if (result.value[1]) {\n            this.joinRoom(result.value[1]);\n          }\n        }\n      });\n    };\n\n    this.joinRoom = value => {\n      this.roomId = value;\n      this.lobbyChannel = 'spotifylobby--' + this.roomId; // Check the number of people in the channel\n\n      this.pubnub.hereNow({\n        channels: [this.lobbyChannel]\n      }).then(response => {\n        if (response.totalOccupancy < 5) {\n          this.pubnub.subscribe({\n            channels: [this.lobbyChannel],\n            withPresence: true\n          });\n          this.setState({\n            player: `${response.totalOccupancy + 1}`\n          });\n          this.pubnub.publish({\n            message: {\n              notRoomCreator: true\n            },\n            channel: this.lobbyChannel\n          });\n        } else {\n          // Game in progress\n          Swal.fire({\n            title: 'Error',\n            text: 'Game is full.'\n          });\n        }\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    this.endGame = () => {\n      this.setState({\n        player: '',\n        isPlaying: false,\n        isRoomCreator: false,\n        isDisabled: false,\n        myTurn: false\n      });\n      this.lobbyChannel = null;\n      this.gameChannel = null;\n      this.roomId = null;\n      this.pubnub.unsubscribe({\n        channels: [this.lobbyChannel, this.gameChannel]\n      });\n    };\n\n    this.pubnub = new PubNubReact({\n      publishKey: \"pub-c-353f0377-1a09-4a4f-be96-1f51d601592c\",\n      subscribeKey: \"sub-c-7cb8e092-8c1a-11eb-9de7-3a1dcc291cdf\"\n    });\n    this.state = {\n      player: '',\n      // 1, 2, 3, 4, 5\n      isPlaying: false,\n      // Set to true when at least 2 players are in a channel\n      isRoomCreator: false,\n      isDisabled: false,\n      myTurn: false\n    };\n    this.lobbyChannel = null; // Lobby channel\n\n    this.gameChannel = null; // Game channel\n\n    this.size = null; // Number of players in room\n\n    this.roomId = null; // Unique id when player creates a room\n\n    this.pubnub.init(this); // Initialize PubNub\n  }\n\n  componentWillUnmount() {\n    this.pubnub.unsubscribe({\n      channels: [this.lobbyChannel, this.gameChannel]\n    });\n  }\n\n  componentDidUpdate() {\n    // Check that the player is connected to a channel\n    if (this.lobbyChannel != null) {\n      this.pubnub.getMessage(this.lobbyChannel, msg => {\n        // Start the game once an opponent joins the channel\n        if (msg.message.notRoomCreator) {\n          // Create a different channel for the game\n          this.gameChannel = 'spotifygame--' + this.roomId;\n          this.pubnub.subscribe({\n            channels: [this.gameChannel]\n          });\n          this.setState({\n            isPlaying: true\n          }); // Close the modals if they are opened\n\n          Swal.close();\n        }\n      });\n    }\n  } // Create a room channel\n\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \" MysteryMusic \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this), !this.state.isPlaying && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"game\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"board\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"button-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"create-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Host\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"Start the game!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 19\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 214,\n                columnNumber: 44\n              }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Create the game for other players to join\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"button \",\n                disabled: this.state.isDisabled,\n                onClick: e => this.onPressCreate(),\n                children: \" Create\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"join-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                children: \"Joiner\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"Join a game!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 19\n              }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Join a game another player is hosting\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"button\",\n                onClick: e => this.onPressJoin(),\n                children: \" Join\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 227,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/egg/Desktop/UPenn/sem 4/pcl/mystery music/my-app/src/App.js"],"names":["React","Component","PubNubReact","Swal","shortid","App","constructor","props","onPressCreate","e","size","roomId","generate","substring","lobbyChannel","pubnub","subscribe","channels","withPresence","mixin","confirmButtonText","showCancelButton","progressSteps","queue","title","text","input","then","result","value","fire","html","setState","player","isRoomCreator","isDisabled","myTurn","onPressJoin","inputPlaceholder","answers","JSON","stringify","joinRoom","hereNow","response","totalOccupancy","publish","message","notRoomCreator","channel","catch","error","console","log","endGame","isPlaying","gameChannel","unsubscribe","publishKey","subscribeKey","state","init","componentWillUnmount","componentDidUpdate","getMessage","msg","close","render"],"mappings":"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","sourcesContent":["// App.js\r\nimport React, { Component } from 'react';\r\nimport * as PubNubReact from 'pubnub-react';\r\nimport Swal from \"sweetalert2\";\r\nimport shortid from 'shortid';\r\nimport './index.css';\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.pubnub = new PubNubReact({\r\n      publishKey: \"pub-c-353f0377-1a09-4a4f-be96-1f51d601592c\",\r\n      subscribeKey: \"sub-c-7cb8e092-8c1a-11eb-9de7-3a1dcc291cdf\"\r\n    });\r\n    this.state = {\r\n      player: '', // 1, 2, 3, 4, 5\r\n      isPlaying: false, // Set to true when at least 2 players are in a channel\r\n      isRoomCreator: false,\r\n      isDisabled: false,\r\n      myTurn: false,\r\n    };\r\n    this.lobbyChannel = null; // Lobby channel\r\n    this.gameChannel = null; // Game channel\r\n    this.size = null; // Number of players in room\r\n    this.roomId = null; // Unique id when player creates a room\r\n    this.pubnub.init(this); // Initialize PubNub\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.pubnub.unsubscribe({\r\n      channels: [this.lobbyChannel, this.gameChannel]\r\n    });\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    // Check that the player is connected to a channel\r\n    if (this.lobbyChannel != null) {\r\n      this.pubnub.getMessage(this.lobbyChannel, (msg) => {\r\n        // Start the game once an opponent joins the channel\r\n        if (msg.message.notRoomCreator) {\r\n          // Create a different channel for the game\r\n          this.gameChannel = 'spotifygame--' + this.roomId;\r\n\r\n          this.pubnub.subscribe({\r\n            channels: [this.gameChannel]\r\n          });\r\n\r\n          this.setState({\r\n            isPlaying: true\r\n          });\r\n\r\n          // Close the modals if they are opened\r\n          Swal.close();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Create a room channel\r\n  onPressCreate = (e) => {\r\n    this.size = 1;\r\n    // Create a random name for the channel\r\n    this.roomId = shortid.generate().substring(0, 5);\r\n    this.lobbyChannel = 'spotifylobby--' + this.roomId;\r\n\r\n    this.pubnub.subscribe({\r\n      channels: [this.lobbyChannel],\r\n      withPresence: true\r\n    });\r\n\r\n    // Open the modal sweetalert2\r\n    Swal.mixin({\r\n      confirmButtonText: 'Next &rarr;',\r\n      showCancelButton: true,\r\n      progressSteps: ['1', '2']\r\n    }).queue([\r\n      {\r\n        title: 'Share this room ID with your friend',\r\n        text: this.roomId\r\n      },\r\n      {\r\n        title: 'Type your spotify here',\r\n        input: 'text'\r\n      }\r\n    ]).then((result) => {\r\n      if (result.value) {\r\n        // not sure if need to stringify with only one input, can't test ):\r\n        // const answers = JSON.stringify(result.value[1])\r\n        Swal.fire({\r\n          html: `\r\n            Your spotify:\r\n            <pre><code>${result.value[1]}</code></pre>\r\n          `,\r\n          confirmButtonText: 'Play!'\r\n        })\r\n      }\r\n    })\r\n\r\n    this.setState({\r\n      player: '1',\r\n      isRoomCreator: true,\r\n      isDisabled: true, // Disable the 'Create' button\r\n      myTurn: true, // Room creator makes the 1st move\r\n    });\r\n  }\r\n\r\n  // The 'Join' button was pressed\r\n  onPressJoin = (e) => {\r\n\r\n    Swal.mixin({\r\n      confirmButtonText: 'Next &rarr;',\r\n      showCancelButton: true,\r\n      progressSteps: ['1', '2']\r\n    }).queue([\r\n      {\r\n        inputPlaceholder: 'Enter the room id',\r\n        input: 'text'\r\n      },\r\n      {\r\n        title: 'Type your spotify here',\r\n        input: 'text'\r\n      }\r\n    ]).then((result) => {\r\n      if (result.value) {\r\n        const answers = JSON.stringify(result.value)\r\n        Swal.fire({\r\n          html: `\r\n            Your spotify:\r\n            <pre><code>${answers[0]}</code></pre>\r\n          `,\r\n          confirmButtonText: 'Play!'\r\n        })\r\n        // Check if the user typed a value in the input field\r\n        if (result.value[1]) {\r\n          this.joinRoom(result.value[1]);\r\n        }\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  // Join a room channel\r\n  joinRoom = (value) => {\r\n    this.roomId = value;\r\n    this.lobbyChannel = 'spotifylobby--' + this.roomId;\r\n\r\n    // Check the number of people in the channel\r\n    this.pubnub.hereNow({\r\n      channels: [this.lobbyChannel],\r\n    }).then((response) => {\r\n      if (response.totalOccupancy < 5) {\r\n        this.pubnub.subscribe({\r\n          channels: [this.lobbyChannel],\r\n          withPresence: true\r\n        });\r\n\r\n        this.setState({\r\n          player: `${response.totalOccupancy + 1}`,\r\n        });\r\n\r\n        this.pubnub.publish({\r\n          message: {\r\n            notRoomCreator: true,\r\n          },\r\n          channel: this.lobbyChannel\r\n        });\r\n      }\r\n      else {\r\n        // Game in progress\r\n        Swal.fire({\r\n          title: 'Error',\r\n          text: 'Game is full.',\r\n        })\r\n      }\r\n    }).catch((error) => {\r\n      console.log(error);\r\n    });\r\n  }\r\n\r\n  // Reset everything\r\n  endGame = () => {\r\n    this.setState({\r\n      player: '',\r\n      isPlaying: false,\r\n      isRoomCreator: false,\r\n      isDisabled: false,\r\n      myTurn: false,\r\n    });\r\n\r\n    this.lobbyChannel = null;\r\n    this.gameChannel = null;\r\n    this.roomId = null;\r\n\r\n    this.pubnub.unsubscribe({\r\n      channels: [this.lobbyChannel, this.gameChannel]\r\n    });\r\n  }\r\n\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className=\"title\">\r\n          <h1> MysteryMusic </h1>\r\n        </div>\r\n        {\r\n          !this.state.isPlaying &&\r\n          <div className=\"game\">\r\n            <div className=\"board\">\r\n              <div className=\"button-container\">\r\n                <div id=\"create-container\">\r\n                  <h2>Host</h2>\r\n                  <h3>Start the game!</h3> <br></br>\r\n                  <h4>Create the game for other players to join</h4>\r\n                <button\r\n                  className=\"button \"\r\n                  disabled={this.state.isDisabled}\r\n                  onClick={(e) => this.onPressCreate()}\r\n                > Create\r\n                </button>\r\n                </div>\r\n                <div id=\"join-container\">\r\n                <h2>Joiner</h2>\r\n                  <h3>Join a game!</h3> <br></br>\r\n                  <h4>Join a game another player is hosting</h4>\r\n                <button\r\n                  className=\"button\"\r\n                  onClick={(e) => this.onPressJoin()}\r\n                > Join\r\n                </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default App;"]},"metadata":{},"sourceType":"module"}